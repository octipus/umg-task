const u=document.querySelectorAll('form[action="/cart/add"]');u.forEach(a=>{a.addEventListener("submit",async e=>{e.preventDefault();const r=new FormData(a),n=a.querySelector("button[type=submit]");n.disabled=!0;try{const t=new XMLHttpRequest;t.open("POST","/cart/add"),t.onload=function(){if(t.status===200){const o=new XMLHttpRequest;o.open("GET","/cart.json"),o.onload=function(){if(o.status===200){const s=JSON.parse(o.responseText);document.querySelectorAll(".cart-count").forEach(d=>{d.textContent=s.item_count});const c=document.createElement("p");c.classList.add("added-to-cart"),c.textContent="Added to cart!",a.appendChild(c),n.disabled=!1}else console.error("Failed to retrieve cart.")},o.send()}else console.error("Failed to add to cart.")},t.send(r)}catch(t){console.error("An error occurred:",t)}})});document.querySelector(".clear-cart").addEventListener("click",function(a){a.preventDefault();var e=new XMLHttpRequest;e.open("POST","/cart/clear.js"),e.onload=function(){e.status===200&&alert("Cleared the cart!")},e.setRequestHeader("Content-Type","application/json"),e.send()});document.querySelectorAll(".updateItem").forEach(function(a){a.addEventListener("click",function(){console.log(this);var e=this.value,r=this.dataset.id,n={updates:{}};n.updates[r]=e;var t=new XMLHttpRequest;t.open("POST","/cart/update.js"),t.setRequestHeader("Content-Type","application/json"),t.onload=function(){t.status===200&&alert("Updated the cart!")},t.send(JSON.stringify(n))})});
